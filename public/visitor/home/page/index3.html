<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home</title>


    <script src="//js.jloads.com/include-html.js"></script>
    <script src="//js.jloads.com/include-url.js"></script>
    <script src="//js.jloads.com/include-module-plugin-in-id.js"></script>
    <script src="//js.jloads.com/message.js"></script>

    <script src="//js.jloads.com/formToObject.min.js"></script>
    <script src="//js.jloads.com/rest.js"></script>
    <script src="//js.jloads.com/rest-module.js"></script>
    <script src="//js.jloads.com/rest-submit.js"></script>

    <script>
        var include = {
            'newsletter': ['create', 'delete'],
            'registration': ['create', 'delete'],
            'auth': ['create', 'delete'],
            'home': []
        };
    </script>

    <script language="JavaScript">
        function addScriptToHead(src) {
            var head = document.getElementsByTagName('head')[0];
            var script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = src;
            head.appendChild(script);
        }
    </script>

</head>
<body>


<div class="home-plugins">
    <div id="plugin-home-create">..loading</div>
    <div id="plugin-registration-create">..loading</div>
    <div id="plugin-registration-delete">..loading</div>
    <div id="plugin-newsletter-create">..loading</div>
    <div id="plugin-newsletter-delete">..loading</div>
    <div id="plugin-auth-create">..loading</div>
    <div id="plugin-auth-delete">..loading</div>
</div>


<script>

    includeModulePluginInId("home", "messages", "plugin-home-create");
    includeModulePluginInId("newsletter", "create", "plugin-newsletter-create");


    // includeModulePluginInId("newsletter", "create", "plugin-newsletter-create", function () {
    // includeModulePluginInId("newsletter", "create", "plugin-newsletter-create", function () {
        //
    //     var form = document.getElementById("newsletter-create");
    //     form.addEventListener("submit", function (event) {
    //         console.log(this);
    //         var data = formToObject(this);
    //
    //         restSubmit("newsletter", 'GET', data, function (data) {
    //             console.error(data);
    //             AddMessage(data.message.error);
    //
    //         }, function (data) {
    //             console.table(data);
    //             AddMessage(data.message.info);
    //         });
    //     });
    //
    // });


    includeModulePluginInId("newsletter", "delete", "plugin-newsletter-delete");

    // restModule("newsletter",  '', '', '', function (data) {
    //     console.error(data);
    //     AddMessage(data.message.error);
    //
    // }, function (data) {
    //     console.table(data);
    //     AddMessage(data.message.info);
    // });

    includeModulePluginInId("registration", "create", "plugin-registration-create");
    includeModulePluginInId("registration", "delete", "registration-delete");


    includeModulePluginInId("auth", "create", "auth-create");
    includeModulePluginInId("auth", "delete", "auth-delete");

</script>


<!--<script src="/visitor/newsletter/js/foot.js"></script>-->
<!--<script src="/visitor/auth/js/foot.js"></script>-->
<!--<script src="/visitor/registration/js/foot.js"></script>-->


<script>
    var delay = 100;
    document.addEventListener("DOMContentLoaded", function () {
        setTimeout(function () {
                addScriptToHead("/visitor/newsletter/js/foot.js");
                addScriptToHead("/visitor/auth/js/foot.js");
                addScriptToHead("/visitor/registration/js/foot.js");
            },
            delay
        );
    });
</script>


</body>
</html>
